<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="icon" type="image/svg+xml" href="https://vitejs.dev/logo.svg" />
    <title>Example - Vite MPA</title>
    <!-- ğŸ” Eruda æ—©æœŸåŠ è½½ï¼šç¡®ä¿èƒ½æ•è·æ‰€æœ‰è¯·æ±‚å’Œé”™è¯¯ -->
    <script>
      ;(function () {
        // æ£€æŸ¥æ˜¯å¦å¯ç”¨äº† erudaï¼ˆä¼šè¯çº§åˆ«ï¼‰
        if (sessionStorage.getItem('vite_mpa_eruda_enabled') !== 'true') {
          return
        }

        // å°è¯•ä» localStorage è¯»å–ç¼“å­˜çš„ eruda ä»£ç 
        var cachedCode = localStorage.getItem('vite_mpa_eruda_code')

        if (cachedCode) {
          // âœ… ä½¿ç”¨ç¼“å­˜çš„ä»£ç ï¼Œç›´æ¥æ‰§è¡Œï¼ˆé¿å…ç½‘ç»œè¯·æ±‚ï¼‰
          try {
            eval(cachedCode)
            window.eruda && window.eruda.init()
          } catch (e) {
            console.error('Eruda ç¼“å­˜ä»£ç æ‰§è¡Œå¤±è´¥:', e)
            // æ¸…é™¤å¤±æ•ˆçš„ç¼“å­˜ï¼Œä¸‹æ¬¡é‡æ–°ä¸‹è½½
            localStorage.removeItem('vite_mpa_eruda_code')
          }
        } else {
          // âŒ æ²¡æœ‰ç¼“å­˜ï¼Œéœ€è¦ä¸‹è½½ï¼ˆä»…é¦–æ¬¡æˆ–ç¼“å­˜å¤±æ•ˆæ—¶ï¼‰
          var script = document.createElement('script')
          script.src = 'https://fastly.jsdelivr.net/npm/eruda'
          script.onload = function () {
            window.eruda && window.eruda.init()

            // ä¸‹è½½æˆåŠŸåï¼Œç¼“å­˜ä»£ç åˆ° localStorage
            fetch('https://fastly.jsdelivr.net/npm/eruda')
              .then(function (res) {
                return res.text()
              })
              .then(function (code) {
                localStorage.setItem('vite_mpa_eruda_code', code)
              })
              .catch(function (err) {
                console.warn('Eruda ä»£ç ç¼“å­˜å¤±è´¥:', err)
              })
          }
          document.head.appendChild(script)
        }
      })()
    </script>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="./main.ts"></script>
  </body>
</html>
